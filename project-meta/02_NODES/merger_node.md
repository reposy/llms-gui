# Merger 노드

### 1. 개요

`Merger` 노드는 여러 개의 들어오는 경로(Upstream 노드들)로부터 입력을 받아 하나의 결과로 병합하는 **프론트엔드 기반 노드**입니다. 모든 입력이 도착할 때까지 기다리는 것이 아니라, 각 입력이 도착할 때마다 현재까지 수집된 항목들을 저장하고 반환하는 특징이 있습니다.

-   **입력:** 여러 소스로부터 다양한 타입의 데이터를 받을 수 있습니다.
-   **처리 (`core/MergerNode.ts` 또는 유사 파일):**
    -   노드가 실행될 때마다 전달된 입력(`input`)을 내부 메모리 또는 상태(`collectedItems` 또는 `content.items` 등)에 추가합니다. (null/undefined 입력은 무시될 수 있음)
    -   **주의:** 현재 알려진 구현에 따르면, 각 입력이 도착할 때마다 **지금까지 수집된 모든 항목의 배열**을 반환합니다. 이는 Merger 노드에 연결된 후속 노드가 여러 번 실행될 수 있음을 의미합니다. (예: 입력 A 도착 -> `[A]` 반환, 입력 B 도착 -> `[A, B]` 반환)
    -   병합 전략(`strategy`) 설정은 `OLD_NODES.md`에서 언급되었으나, 실제 `execute` 로직에서 직접 사용되는지 여부는 현재 코드 기준으로 확인이 필요합니다. 기본적으로는 배열로 누적하여 동작하는 것으로 보입니다.
-   **출력:** 현재까지 수집된 모든 입력 항목을 포함하는 **배열 (Array)**.

### 2. 프론트엔드 UI (노드 설정 패널 - `MergerNodeConfig.tsx`, 상세 사이드바 - `MergerNodeSidebar.tsx` 또는 유사 UI)

-   **(설정 패널)**
    -   `OLD_NODES.md`에 따르면 병합 전략 (`array` 또는 `object`) 및 객체 키 지정 옵션이 언급되었으나, 실제 UI 컴포넌트(`MergerNodeConfig.tsx`)에 해당 설정이 명시적으로 구현되어 있는지는 확인이 필요합니다. 현재는 특별한 설정 없이 기본 배열 병합으로 동작할 가능성이 높습니다.
-   **(상세 사이드바 또는 노드 내부 UI)**
    -   **Collected Items:** Merger 노드가 실행되면서 수집된 항목들의 목록(또는 개수)을 실시간으로 표시할 수 있습니다.
    -   *(미래 기능 또는 고급 설정)* 수동으로 병합된 결과를 후속 노드로 전달하는 트리거 버튼 등이 추가될 수 있습니다.

### 3. 실행 로직 (`core/MergerNode.ts`)

1.  `execute` 메서드가 호출됩니다.
2.  수신된 `input`이 유효하면 (null/undefined가 아니면) 내부적으로 관리되는 `collectedItems` 배열 (또는 Zustand 스토어의 `content.items` 등)에 추가합니다.
3.  업데이트된 `collectedItems` 배열을 UI에 반영하기 위해 Zustand 스토어 등에 저장할 수 있습니다.
4.  업데이트된 `collectedItems` 배열의 복사본을 `storeOutput`으로 저장합니다.
5.  **현재 `collectedItems` 배열의 복사본을 반환합니다.** 이로 인해 이 노드에 연결된 하위 노드들은 Merger 노드로 입력이 들어올 때마다 실행될 수 있습니다.

**참고:** 현재 설계는 각 입력마다 후속 노드가 실행되므로, 모든 연결된 부모 노드들로부터 입력이 완료된 후에만 후속 처리를 하려면 Merger 노드 다음에 특정 조건(예: 예상 입력 개수 도달)을 만족할 때만 실행을 시작하는 별도의 로직(예: `Conditional` 노드 또는 `Group` 노드와 조합)이 필요할 수 있습니다. 혹은 모든 입력이 모일 때까지 대기하는 로직이 Merger 노드 자체에 추가될 수도 있습니다 (현재 문서 내용 기반으로는 각 입력마다 실행).

### 4. 백엔드 상호작용 및 역할

-   Merger 노드는 **프론트엔드 기반 노드**이며, 백엔드와 직접 상호작용하지 않습니다.

### 5. 데이터 흐름 및 출력 형식

-   **입력:** Any 타입 (여러 소스로부터).
-   **처리:** 프론트엔드 메모리 및/또는 상태 스토어에 입력 누적.
-   **출력:** 현재까지 누적된 모든 입력을 담은 **배열 (Array)**. 입력이 발생할 때마다 이 배열이 출력됩니다. 