# UI Guideline for Flow Editor

이 문서는 본 프로젝트의 노드 기반 Flow Editor UI/UX 규칙을 명확히 정의합니다. 실제 구현 및 논의된 내용을 바탕으로 작성되었습니다.

---

## 1. 노드 공통 UI/UX 규칙

- **노드는 항상 주요 정보를 표시**
  - 라벨, 아이콘, 요약 등 핵심 정보는 포커싱 여부와 무관하게 항상 노드 내에 표시
- **노드 헤더 라벨:** 노드 상단 헤더의 라벨은 편집 가능하며, 기본적으로 `data.label` 값을 표시합니다. (`EditableNodeLabel` 공통 컴포넌트 사용)
- **포커싱(선택) 시**
  - 노드 테두리에 강조(파란색 등) 효과 적용
  - 상세 설정 UI(폼 등)가 추가로 노출될 수 있음
- **포커싱 해제 시**
  - 테두리 강조가 사라지고, 평범한 테두리만 남음
  - 내용(라벨, 요약 등)은 그대로 유지
- **선택 시:** 노드 테두리에 해당 노드 타입의 테마 색상(예: LLM-파랑, Group-주황)으로 강조 효과 적용.
- **결과 표시:** 대부분의 노드는 하단에 결과 영역을 가지며, 결과가 없으면 플레이스홀더를 표시합니다.
- **축소/확대:** 노드 우측 상단의 버튼을 통해 컴팩트 뷰와 확장 뷰를 전환할 수 있습니다. (모든 노드에 적용 예정)

## 1.5. 사이드바 공통 규칙

- **헤더 형식:** 노드 선택 시 나타나는 오른쪽 설정/상세 사이드바의 헤더는 **`{Label} | {Formatted Type Name}`** 형식을 따릅니다. (예: `My Summary | Llm`, `Crawled Data | Web Crawler`). `Formatted Type Name` 은 노드 타입 문자열(예: `html-parser`)을 보기 좋게 변환한 이름(예: `Html Parser`)입니다. 라벨이 비어있으면 타입 이름이 라벨 자리에 사용됩니다. (구현: `src/utils/ui/textFormatUtils.ts`의 `formatNodeHeaderText`)

---

## 2. LLM Node UI/UX

- **항상 전체 UI(라벨, 모델, 프롬프트, 온도, Provider, 모드 등) 노출**
- **포커싱 시**
  - 테두리에 파란색 강조 효과
  - 상세 설정 UI(폼) 그대로 유지
- **포커싱 해제 시**
  - 테두리 강조만 사라지고, 모든 내용은 그대로 노출
- **확장 뷰:** 모델, 프롬프트, 온도, Provider, 모드(Text/Vision) 등 주요 설정을 표시합니다.
- **축소 뷰:** 라벨, 모델, Provider, 프롬프트 일부만 간략히 표시합니다.
- **Result(결과) 영역**
  - 노드 하단에 항상 표시
  - 결과가 없으면 "No result yet." 표시
  - 결과가 있으면 실제 결과 텍스트(또는 마크다운, JSON 등) 표시
  - 노드 하단에 위치하며, **3줄을 초과하는 결과는 말줄임표(...) 처리**됩니다.
- **사이드바 결과:** 오른쪽 설정 사이드바(`LLMConfig`)의 **Prompt 영역 아래에 전체 결과(Full Result)** 가 표시됩니다.
- **축소/확대 버튼:** 컴팩트 뷰 우측 하단에 확대 버튼이, 확장 뷰 헤더 우측 상단에 축소 버튼이 표시됩니다.

---

## 3. Input Node UI/UX

- **항상 전체 UI(라벨, 입력 모드 토글, 텍스트/파일 입력, 아이템 리스트 등) 노출**
- **Batch/ForEach 모드 전환**
  - `iterateEachRow` 상태로만 관리 (executionMode 등 불필요)
  - UI에서 명확히 구분(버튼, 토글 등)
  - **모드 전환 토글 버튼은 아이템 개수와 상관없이 항상 표시됩니다.**
- **포커싱 시**
  - 테두리 강조(파란색 등)
- **포커싱 해제 시**
  - 테두리 강조 해제, 내용은 그대로
- **입력 아이템 리스트, 요약, 파일 업로드 등은 항상 표시**

---

## 4. Group Node UI/UX

- **그룹 노드는 내부에 다른 노드를 포함할 수 있는 컨테이너 역할을 함**
- **시각적 표현**
  - 넓은 영역을 가진 사각형으로 표시 (기본 크기: 1200 x 700)
  - 배경색은 반투명하게 적용하여 그룹과 내부 노드를 구분
  - 테두리 색상으로 선택 상태 표시 (선택 시 진한 색, 미선택 시 연한 색)
- **노드 배치 및 이동**
  - 그룹 노드 영역 안으로 다른 노드를 드래그하면 자동으로 부모-자식 관계 설정
  - **중요**: 그룹 내 자식 노드는 원래 위치(절대 좌표)를 유지함
  - 그룹 노드를 이동하면 내부의 모든 자식 노드도 함께 이동함
  - 자식 노드를 그룹 밖으로 드래그하면 부모-자식 관계가 해제됨
- **상호작용**
  - 그룹 헤더에는 실행 버튼이 있어 그룹 내 모든 노드를 일괄 실행 가능
  - 그룹 내 노드 목록이 우측 상단에 표시됨
  - 그룹 자체 선택 시 그룹 노드의 리사이즈 핸들이 표시됨
- **기술적 구현**
  - 자식 노드는 `parentId` 속성만 사용 (`extent: 'parent'` 속성 사용 안 함)
  - 자식 노드와 부모 그룹 간 상대 좌표 변환을 하지 않고 절대 좌표 유지

---

## 5. 상태/강조 및 시각적 규칙

- **selected(포커싱) 클래스**
  - `.llm-node-container.selected` 등으로 테두리 강조
  - CSS 예시:
    ```css
    .llm-node-container {
      border: 2px solid #e0e7ef;
      border-radius: 16px;
      background: #fff;
    }
    .llm-node-container.selected {
      border: 2px solid #3b82f6;
      box-shadow: 0 0 0 2px #3b82f633;
    }
    ```
- **노드 크기, 여백, 폰트 등은 일관성 있게 유지**
- **모든 노드는 NodeErrorBoundary로 감싸 예외 발생 시에도 UI가 깨지지 않도록 함**

---

## 6. 기타

- **불필요한 분기(빈 div 반환 등)는 금지**
  - 항상 주요 정보와 UI가 노출되어야 함
- **상태 전환(포커싱, 모드 변경 등) 시 setState/setContent 등은 올바른 타입/필드만 사용**
- **모든 노드는 UX 일관성을 유지하며, 사용자에게 명확한 피드백(강조, 결과, placeholder 등)을 제공해야 함**

---

이 가이드라인은 실제 구현과 논의된 내용을 바탕으로 지속적으로 업데이트됩니다. 